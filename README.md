## 🌫️ D-YOLO 기반 안개 환경 객체 탐지 성능 향상 연구

### 🎯 프로젝트 목표

본 프로젝트의 최종 목표는 **D-YOLO** 모델을 기반으로 안개가 낀(**Hazy**) 환경에서의 **객체 탐지 성능을 향상**시키는 것입니다.

1.  **베이스라인 확보**: D-YOLO 원본 구조 구현 및 성능 측정.
2.  **모듈 개선**: 핵심 모듈인 CWD Loss와 AFF(Attention Feature Fusion)를 각각 더 진보된 방식인 **FGD Loss**와 **AFF + ASFF**로 교체하여 원본 D-YOLO 모델 대비 성능 향상을 달성합니다.

---

### 🏗️ 주요 아키텍처 및 개선 방향

#### 1. 베이스라인: D-YOLO

D-YOLO는 안개 낀 이미지($F_h$)와 선명한 이미지($F_c$)의 특징(feature)을 함께 활용하여 학습하는 모델입니다.

| 모듈 | 설명 |
| :--- | :--- |
| **Backbone (Hazy)** | YOLOv8 Backbone을 사용하여 **안개 낀 이미지의 특징($F_h$)**을 추출합니다. |
| **Guide Network (Clear)** | 학습 시에만 DarkNet53 기반의 CFE 서브넷을 사용하여 **선명한 이미지의 특징($F_c$)**을 추출합니다. |
| **Neck 1 (Feature Adaption)** | **CWD Loss**를 사용하여 $F_h$를 $F_c$와 유사해지도록 변환('안개 제거된 특징 $F_d$' 생성)합니다. |
| **Neck 2 (Attention Feature Fusion)** | 원본의 $F_h$와 안개 제거된 $F_d$를 **AFF**로 융합하여 정보 손실을 최소화하고 탐지 정확도를 높입니다. |

---

#### 2. 개선 계획

| 구분 | 기존 방식 | 개선 방식 | 목표 및 기대 효과 |
| :--- | :--- | :--- | :--- |
| **Loss 개선** | CWD Loss (모든 픽셀 동일 가중치) | **FGD (Focal Distillation) Loss** | 객체/배경 중요도에 따른 가중치 부여 및 전역적 맥락(Global Distillation) 학습을 통해 Distillation 효율 극대화. |
| **Fusion 개선** | AFF (두 가지 특징 조합) | **AFF + ASFF** (Adaptively Spatial Feature Fusion) | 픽셀 위치별 최적 스케일 정보 자동 학습으로 **악천후 강건성** 및 **스케일 적응성** 동시 확보. |

---

### 📊 데이터셋

| 구분 | 데이터셋 | 내용 | 규모 |
| :--- | :--- | :--- | :--- |
| **학습 (Train)** | PASCAL VOC 2007 & 2012 (원본) | 선명한 이미지 | 9,578장 |
| **학습 (Train)** | 합성 안개 이미지 | 대기 산란 모델($I(x)=J(x)t(x)+A(1-t(x))$)을 이용해 생성 | 9,578장 |
| **평가 (Test)** | RTTS | 실제 안개 환경 데이터 | 4,320장 |
| **평가 (Test)** | Foggy Cityscapes | 합성 안개 환경 데이터 | 491장 |
| **평가 (Test)** | Foggy Driving Dataset | 실제 안개 환경 데이터 | 101장 |

---

### 🗓️ 향후 계획 (Timeline)

| 단계 | 개발 항목 | 9월 | 10월 | 11월 | 12월 |
| :--- | :--- | :---: | :---: | :---: | :---: |
| **1단계** | D-YOLO 원본 모델 구현 및 베이스라인 성능 측정 | ✅ | | | |
| **2단계** | FA (FGD) 개선 모듈 구현 및 테스트 | | ✅ | | |
| **2단계** | AFF (ASFF) 개선 모듈 구현 및 테스트 | | | ✅ | |
| **2단계** | 1차 통합 및 테스트 | | | ✅ | |
| **3단계** | 실험 결과 분석 및 최종 보고서 작성 | | | | ✅ |

---

### 👥 팀 구성 (전과자팀)

* **팀장**: 제승완
* **팀원**: 문규성
* **팀원**: 신성준
